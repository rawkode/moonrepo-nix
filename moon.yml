project:
  name: "moonrepo-nix"
  description: "Moon plugin for Nix integration"
  owner: "rawkode"

fileGroups:
  source:
    - "src/**/*.rs"
    - "Cargo.toml"
  tests:
    - "tests/**/*.rs"

tasks:
  build:
    description: "Build the WASM plugin in debug mode"
    command: "cargo build --target wasm32-wasip1"
    outputs:
      - "target/wasm32-wasip1/debug/moon_toolchain_nix.wasm"

  build-release:
    description: "Build the WASM plugin in release mode"
    command: "cargo build --target wasm32-wasip1 --release"
    outputs:
      - "target/wasm32-wasip1/release/moon_toolchain_nix.wasm"

  install:
    description: "Copy the debug plugin to root"
    command: "cp target/wasm32-wasip1/debug/moon_toolchain_nix.wasm ."
    deps:
      - "build"

  install-release:
    description: "Copy the release plugin to root"
    command: "cp target/wasm32-wasip1/release/moon_toolchain_nix.wasm ."
    deps:
      - "build-release"

  check:
    description: "Check code for errors"
    command: "cargo check --target wasm32-wasip1"

  clippy:
    description: "Run clippy lints"
    command: "cargo clippy --target wasm32-wasip1 -- -D warnings"

  fmt:
    description: "Format code"
    command: "cargo fmt"

  fmt-check:
    description: "Check code formatting"
    command: "cargo fmt -- --check"

  clean:
    description: "Clean build artifacts"
    command: "cargo clean"
